# ğŸš€ Buddy é¡¹ç›®æ„å»ºç³»ç»Ÿ

Buddy é¡¹ç›®ç°åœ¨ä½¿ç”¨ç°ä»£åŒ–çš„æ„å»ºç³»ç»Ÿï¼Œç»“åˆäº† **Turbo** å’Œ **PNPM Workspace** æ¥ç®¡ç†å•ä½“ä»“åº“çš„ä¾èµ–å…³ç³»å’Œæ„å»ºæµç¨‹ã€‚

## ğŸ“¦ é¡¹ç›®ä¾èµ–å›¾

```
@coffic/cosy-framework â† @coffic/cosy-framework â† @coffic/cosy-keyboard
                     â†˜
@coffic/buddy-types â† buddy (ä¸»åº”ç”¨)
                 â†˜
                   æ‰€æœ‰æ’ä»¶åŒ…
```

## ğŸ”§ å¯ç”¨çš„æ„å»ºå‘½ä»¤

### åŸºç¡€æ„å»ºå‘½ä»¤

```bash
# æ„å»ºæ‰€æœ‰åŒ…ï¼ˆæ™ºèƒ½ä¾èµ–é¡ºåºï¼‰
pnpm build

# åªæ„å»ºæ ¸å¿ƒä¾èµ–åŒ…
pnpm build:deps

# åªæ„å»ºä¸»åº”ç”¨
pnpm build:buddy

# æ„å»ºæ‰€æœ‰æ’ä»¶
pnpm build:plugins

# æ„å»º macOS ç‰ˆæœ¬ï¼ˆåŒ…å«ä¾èµ–ï¼‰
pnpm build:buddy:mac
```

### å¼€å‘æ¨¡å¼å‘½ä»¤

```bash
# å¯åŠ¨å¼€å‘ç¯å¢ƒï¼ˆå¹¶è¡Œæ¨¡å¼ï¼‰
pnpm dev

# åªå¯åŠ¨ä¾èµ–åŒ…çš„ watch æ¨¡å¼
pnpm dev:deps

# åªå¯åŠ¨ä¸»åº”ç”¨å¼€å‘æ¨¡å¼
pnpm dev:buddy

# æ™ºèƒ½å¼€å‘æ¨¡å¼ï¼ˆå…ˆå¯åŠ¨ä¾èµ–ï¼Œå†å¯åŠ¨ä¸»åº”ç”¨ï¼‰
pnpm dev:watch
```

### æ™ºèƒ½æ„å»ºè„šæœ¬

```bash
# ä½¿ç”¨æ™ºèƒ½æ„å»ºè„šæœ¬
pnpm smart:build    # æ™ºèƒ½æ„å»ºæ‰€æœ‰åŒ…
pnpm smart:dev      # æ™ºèƒ½å¹¶è¡Œå¼€å‘æ¨¡å¼
pnpm smart:deps     # åªæ„å»ºä¾èµ–åŒ…

# ç›´æ¥ä½¿ç”¨è„šæœ¬ï¼ˆæ›´å¤šé€‰é¡¹ï¼‰
node scripts/smart-build.mjs build           # æ„å»ºæ‰€æœ‰
node scripts/smart-build.mjs build buddy     # æ„å»ºæŒ‡å®šåŒ…
node scripts/smart-build.mjs dev-parallel    # å¹¶è¡Œå¼€å‘æ¨¡å¼
```

### å…¶ä»–å®ç”¨å‘½ä»¤

```bash
# ä»£ç æ£€æŸ¥
pnpm lint

# è¿è¡Œæµ‹è¯•
pnpm test

# ç±»å‹æ£€æŸ¥
pnpm typecheck

# æ¸…ç†æ„å»ºäº§ç‰©
pnpm clean
```

## ğŸ¯ æ¨èå·¥ä½œæµ

### é¦–æ¬¡æ„å»º

```bash
# 1. å®‰è£…ä¾èµ–
pnpm install

# 2. æ„å»ºæ‰€æœ‰ä¾èµ–åŒ…
pnpm smart:deps

# 3. å¯åŠ¨å¼€å‘ç¯å¢ƒ
pnpm smart:dev
```

### æ—¥å¸¸å¼€å‘

```bash
# å¯åŠ¨æ™ºèƒ½å¼€å‘æ¨¡å¼ï¼ˆæ¨èï¼‰
pnpm smart:dev
```

è¿™ä¼šï¼š

1. ğŸ”§ å¯åŠ¨æ‰€æœ‰ä¾èµ–åŒ…çš„ watch æ¨¡å¼
2. â³ ç­‰å¾…ä¾èµ–åŒ…æ„å»ºå®Œæˆ
3. ğŸ¯ å¯åŠ¨ä¸»åº”ç”¨å¼€å‘æœåŠ¡å™¨

### ç”Ÿäº§æ„å»º

```bash
# æ„å»ºæ‰€æœ‰åŒ…
pnpm build

# æˆ–è€…åˆ†æ­¥æ„å»º
pnpm smart:deps     # å…ˆæ„å»ºä¾èµ–
pnpm build:buddy    # å†æ„å»ºä¸»åº”ç”¨
```

## âš¡ æ€§èƒ½ä¼˜åŒ–ç‰¹æ€§

### Turbo ç¼“å­˜

- **æ™ºèƒ½ç¼“å­˜**: åªé‡å»ºå˜æ›´çš„åŒ…
- **å¹¶è¡Œæ„å»º**: æ— ä¾èµ–çš„åŒ…å¹¶è¡Œæ„å»º
- **å¢é‡æ„å»º**: åŸºäºæ–‡ä»¶å˜æ›´çš„å¢é‡æ„å»º

### ä¾èµ–ç®¡ç†

- **è‡ªåŠ¨ä¾èµ–è§£æ**: è‡ªåŠ¨è®¡ç®—æ„å»ºé¡ºåº
- **å¾ªç¯ä¾èµ–æ£€æµ‹**: é˜²æ­¢å¾ªç¯ä¾èµ–é—®é¢˜
- **æ™ºèƒ½è¿‡æ»¤**: åªæ„å»ºéœ€è¦çš„åŒ…

## ğŸ” æ•…éšœæ’é™¤

### æ„å»ºå¤±è´¥

```bash
# æ¸…ç†æ‰€æœ‰æ„å»ºäº§ç‰©
pnpm clean

# é‡æ–°æ„å»ºä¾èµ–
pnpm smart:deps

# æŸ¥çœ‹æ„å»ºè®¡åˆ’ï¼ˆä¸æ‰§è¡Œï¼‰
pnpm exec turbo run build --dry
```

### ä¾èµ–é—®é¢˜

```bash
# é‡æ–°å®‰è£…ä¾èµ–
rm -rf node_modules
pnpm install

# é‡æ–°æ„å»ºç±»å‹å®šä¹‰
pnpm --filter @coffic/buddy-types build
```

### å¼€å‘ç¯å¢ƒé—®é¢˜

```bash
# åœæ­¢æ‰€æœ‰è¿›ç¨‹ï¼Œé‡æ–°å¯åŠ¨
# Ctrl+C åœæ­¢å½“å‰è¿›ç¨‹

# é‡æ–°å¯åŠ¨å¼€å‘ç¯å¢ƒ
pnpm smart:dev
```

## ğŸ“Š ç›‘æ§æ„å»ºæ€§èƒ½

```bash
# æŸ¥çœ‹æ„å»ºæ—¶é—´ç»Ÿè®¡
pnpm exec turbo run build --summarize

# ç”Ÿæˆæ„å»ºå›¾
pnpm exec turbo run build --graph
```

## ğŸ›  è‡ªå®šä¹‰é…ç½®

### ä¿®æ”¹ Turbo é…ç½®

ç¼–è¾‘ `turbo.json` æ¥è°ƒæ•´æ„å»ºé…ç½®ï¼š

```json
{
  "tasks": {
    "build": {
      "dependsOn": ["^build"],
      "outputs": ["dist/**", "out/**"],
      "inputs": ["src/**", "*.ts", "package.json"]
    }
  }
}
```

### ä¿®æ”¹ä¾èµ–å›¾

ç¼–è¾‘ `scripts/smart-build.mjs` ä¸­çš„ `DEPENDENCY_GRAPH` æ¥è°ƒæ•´ä¾èµ–å…³ç³»ã€‚

## ğŸ‰ ä¼˜åŠ¿æ€»ç»“

1. **ğŸš€ æ›´å¿«çš„æ„å»ºé€Ÿåº¦**: æ™ºèƒ½ç¼“å­˜å’Œå¹¶è¡Œæ„å»º
2. **ğŸ”§ ç®€åŒ–çš„å¼€å‘æµç¨‹**: ä¸€ä¸ªå‘½ä»¤å¯åŠ¨æ‰€æœ‰æœåŠ¡
3. **ğŸ“¦ è‡ªåŠ¨ä¾èµ–ç®¡ç†**: æ— éœ€æ‰‹åŠ¨ç®¡ç†æ„å»ºé¡ºåº
4. **ğŸ›¡ï¸ é”™è¯¯é¢„é˜²**: å¾ªç¯ä¾èµ–æ£€æµ‹å’Œç±»å‹å®‰å…¨
5. **ğŸ“Š å¯è§†åŒ–**: æ„å»ºå›¾å’Œæ€§èƒ½ç»Ÿè®¡

ç°åœ¨ä½ å¯ä»¥æ›´åŠ é«˜æ•ˆåœ°å¼€å‘ Buddy é¡¹ç›®äº†ï¼ğŸ¯
