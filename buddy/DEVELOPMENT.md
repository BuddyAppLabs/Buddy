# Buddy 开发文档

## 项目结构

Buddy 是 GitOK 工作空间中的一个 Electron 应用项目。它依赖于工作空间中的其他包，特别是 `@coffic/active-app-monitor` 原生模块。

## 工作空间依赖

### 本地开发

在 `package.json` 中，你会看到类似这样的依赖配置：

```json
{
  "dependencies": {
    "@coffic/active-app-monitor": "workspace:*"
  }
}
```

这种配置有以下特点：

1. **工作空间协议**
   - `workspace:*` 表示使用工作空间中的包
   - 本地开发时直接链接到工作空间中的源码
   - 修改依赖包后无需发布新版本即可测试

2. **开发优势**
   - 支持多包联合开发
   - 实时反映依赖包的修改
   - 便于调试和测试

3. **注意事项**
   - 确保依赖包（如 active-app-monitor）已在本地构建
   - 修改依赖包后可能需要重启 Electron 应用
   - 开发时注意版本兼容性

### 生产环境

当项目发布时：

1. **依赖解析**
   - pnpm 会自动将 `workspace:*` 替换为具体版本号
   - 用户安装时从 npm 仓库获取发布的包
   - 不依赖工作空间结构

2. **版本管理**
   - 发布前确保依赖包已发布到 npm
   - 注意依赖包的版本兼容性
   - 建议使用语义化版本号

## 开发流程

1. **环境准备**

   ```bash
   # 安装所有工作空间依赖
   pnpm install
   
   # 构建依赖包
   cd ../active-app-monitor
   pnpm run build
   
   # 返回 buddy 目录
   cd ../buddy
   ```

2. **开发调试**

   ```bash
   # 启动开发服务器
   pnpm dev
   ```

3. **构建发布**

   ```bash
   # 构建应用
   pnpm build
   ```

## 常见问题

### Q1: 为什么要使用工作空间依赖？

- 便于多包联合开发
- 支持实时修改和测试
- 简化版本管理

### Q2: 如何处理依赖包的更新？

1. 在依赖包目录中修改代码
2. 构建依赖包
3. 重启 Electron 应用以加载新的变更

### Q3: 发布前需要注意什么？

1. 确保所有依赖包都已发布到 npm
2. 确保版本号正确
3. 测试打包后的应用
