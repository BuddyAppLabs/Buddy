<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<svg width="800" height="600" xmlns="http://www.w3.org/2000/svg">
    <style>
        .container {
            fill: #f5f5f5;
            stroke: #bdc3c7;
            stroke-width: 2;
        }

        .component {
            fill: white;
            stroke: #2c3e50;
            stroke-width: 2;
        }

        .main-process {
            fill: #3498db;
            stroke: #2980b9;
        }

        .renderer-process {
            fill: #2ecc71;
            stroke: #27ae60;
        }

        .plugin {
            fill: #e74c3c;
            stroke: #c0392b;
        }

        .arrow {
            stroke: #2c3e50;
            stroke-width: 2;
            marker-end: url(#arrowhead);
        }

        .dashed {
            stroke-dasharray: 5, 5;
        }

        text {
            font-family: Arial, sans-serif;
            font-size: 14px;
            fill: #2c3e50;
            text-anchor: middle;
        }

        .process-text {
            fill: white;
            font-weight: bold;
        }

        .title {
            font-size: 20px;
            font-weight: bold;
        }

        .subtitle {
            font-size: 16px;
            font-weight: bold;
        }

        .label {
            font-size: 12px;
            fill: #7f8c8d;
        }
    </style>

    <defs>
        <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
            <polygon points="0 0, 10 3.5, 0 7" fill="#2c3e50" />
        </marker>
    </defs>

    <text x="400" y="30" class="title">Buddy 插件系统架构</text>

    <!-- Main Container -->
    <rect x="50" y="50" width="700" height="500" rx="10" class="container" />

    <!-- Main Process -->
    <rect x="80" y="80" width="300" height="250" rx="10" class="container main-process" />
    <text x="230" y="100" class="process-text">Main Process</text>

    <!-- Renderer Process -->
    <rect x="420" y="80" width="300" height="250" rx="10" class="container renderer-process" />
    <text x="570" y="100" class="process-text">Renderer Process</text>

    <!-- Plugin Host -->
    <rect x="80" y="350" width="640" height="180" rx="10" class="container" />
    <text x="400" y="370" class="subtitle">Plugin Host</text>

    <!-- Main Process Components -->
    <rect x="100" y="120" width="120" height="60" rx="5" class="component" />
    <text x="160" y="155">Plugin Manager</text>

    <rect x="100" y="200" width="120" height="60" rx="5" class="component" />
    <text x="160" y="235">Plugin Installer</text>

    <rect x="240" y="120" width="120" height="60" rx="5" class="component" />
    <text x="300" y="155">Plugin Loader</text>

    <rect x="240" y="200" width="120" height="60" rx="5" class="component" />
    <text x="300" y="235">Plugin Registry</text>

    <!-- Renderer Process Components -->
    <rect x="440" y="120" width="120" height="60" rx="5" class="component" />
    <text x="500" y="155">Plugin UI</text>

    <rect x="440" y="200" width="120" height="60" rx="5" class="component" />
    <text x="500" y="235">API Bridge</text>

    <rect x="580" y="120" width="120" height="60" rx="5" class="component" />
    <text x="640" y="155">Settings UI</text>

    <rect x="580" y="200" width="120" height="60" rx="5" class="component" />
    <text x="640" y="235">UI Extension Points</text>

    <!-- Plugin Components -->
    <rect x="100" y="390" width="180" height="60" rx="5" class="component plugin" />
    <text x="190" y="425" fill="white">Plugin A</text>

    <rect x="310" y="390" width="180" height="60" rx="5" class="component plugin" />
    <text x="400" y="425" fill="white">Plugin B</text>

    <rect x="520" y="390" width="180" height="60" rx="5" class="component plugin" />
    <text x="610" y="425" fill="white">Plugin C</text>

    <rect x="100" y="460" width="600" height="50" rx="5" class="component" />
    <text x="400" y="490">Plugin Sandbox &amp; Permission System</text>

    <!-- Connections -->
    <!-- Main Process Internal -->
    <line x1="160" y1="180" x2="160" y2="200" class="arrow" />
    <line x1="300" y1="180" x2="300" y2="200" class="arrow" />
    <line x1="220" y1="150" x2="240" y2="150" class="arrow" />
    <line x1="220" y1="220" x2="240" y2="220" class="arrow" />

    <!-- Main to Renderer -->
    <path d="M 340 150 C 380 150, 380 150, 440 150" fill="none" class="arrow" />
    <path d="M 340 220 C 380 220, 380 220, 440 220" fill="none" class="arrow" />
    <text x="390" y="140" class="label">IPC</text>

    <!-- Renderer Internal -->
    <line x1="560" y1="150" x2="580" y2="150" class="arrow" />
    <line x1="560" y1="220" x2="580" y2="220" class="arrow" />
    <line x1="500" y1="180" x2="500" y2="200" class="arrow" />

    <!-- To Plugin Host -->
    <line x1="160" y1="260" x2="160" y2="350" class="arrow" />
    <line x1="300" y1="260" x2="300" y2="350" class="arrow" />
    <line x1="500" y1="260" x2="500" y2="350" class="arrow" />
    <line x1="640" y1="260" x2="640" y2="350" class="arrow" />

    <!-- Plugin Interaction -->
    <line x1="190" y1="390" x2="190" y2="350" class="arrow dashed" />
    <line x1="400" y1="390" x2="400" y2="350" class="arrow dashed" />
    <line x1="610" y1="390" x2="610" y2="350" class="arrow dashed" />

    <line x1="190" y1="450" x2="190" y2="460" class="arrow" />
    <line x1="400" y1="450" x2="400" y2="460" class="arrow" />
    <line x1="610" y1="450" x2="610" y2="460" class="arrow" />
</svg>