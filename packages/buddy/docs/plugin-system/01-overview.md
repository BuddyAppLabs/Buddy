# GitOK 插件系统概述

GitOK 提供了一个强大而灵活的插件系统，允许开发者扩展应用的功能。本文档将介绍插件系统的核心概念、架构设计以及基本使用方法。

## 什么是 GitOK 插件系统？

GitOK 插件系统是一个允许第三方开发者为应用添加新功能的扩展机制。它基于以下核心理念设计：

- **解耦核心与扩展**：插件系统将核心应用与扩展功能分离，使应用更加模块化
- **简单易用**：插件开发简单，无需深入了解应用内部架构
- **安全沙箱**：插件在受控环境中运行，避免影响应用稳定性
- **丰富 API**：提供丰富的应用接口，让插件能够实现多样化的功能

## 插件系统架构

GitOK 插件系统采用主进程和渲染进程协作的架构，基于 Electron 的进程模型构建。整体架构如下：

```
              +---------------------+
              |      App.vue        |
              | (插件功能消费入口)   |
              +----------+----------+
                         |
                         v
+---------------+  +-----+------------+  +-----------------+
|               |  | PluginManager.vue |  |                |
| ActionView.vue+<-+ (渲染进程插件管理) +->+ PluginStore.vue |
|               |  |                   |  |                |
+---------------+  +--------+----------+  +-----------------+
                            |
                            | IPC通信
                            v
                  +----------+-----------+
                  |    主进程插件系统     |
                  |    (plugin-loader)   |
                  +-+--------+--------+--+
                    |        |        |
                    v        v        v
           +--------+--+ +---+------+ +----+-----+
           | 本地插件1  | | 本地插件2 | | 已安装插件 |
           +-----------+ +----------+ +----------+
```

### 核心组件

插件系统由以下核心组件组成：

1. **插件加载器**：负责发现、加载和管理插件
2. **插件管理器**：集中管理所有已加载的插件，提供统一的 API 接口
3. **IPC 通信层**：负责主进程和渲染进程之间的通信
4. **渲染进程组件**：包括插件管理、动作执行和视图渲染等功能
5. **插件商店**：管理插件的安装、更新和卸载

## 插件的核心概念

在 GitOK 插件系统中，有以下关键概念：

### 插件

插件是一个符合特定规范的 JavaScript 模块，它暴露特定的接口方法，并实现自定义功能。每个插件必须提供：

- **元数据**：包括 ID、名称、描述、版本等基本信息
- **动作列表**：插件提供的功能集合
- **执行方法**：实现动作的具体逻辑
- **可选视图**：为动作提供自定义界面

### 动作 (Actions)

动作是插件暴露给用户的具体功能单元。每个动作包含：

- **唯一标识符**：用于区分不同的动作
- **标题和描述**：向用户展示动作的功能
- **图标**：视觉呈现
- **执行逻辑**：实现动作功能的代码
- **可选视图路径**：指向自定义 UI 的路径

### 视图 (Views)

插件可以为动作提供自定义 UI，通过视图实现更复杂的交互体验。视图是 HTML 内容，可以包含：

- **HTML 结构**：定义 UI 元素
- **CSS 样式**：控制 UI 外观
- **JavaScript 交互**：实现用户交互逻辑

## 插件系统工作流程

GitOK 插件系统的工作流程如下：

1. **插件发现**：系统启动时，插件加载器扫描插件目录
2. **插件加载**：验证并加载符合规范的插件
3. **动作注册**：收集所有插件提供的动作
4. **用户交互**：用户在界面上搜索并选择动作
5. **动作执行**：触发相应插件的执行方法
6. **结果呈现**：根据动作类型，显示结果或自定义视图

## 插件目录结构

插件系统使用两个主要目录：

- **本地插件目录**：`packages/plugins/`，用于开发和调试插件
- **已安装插件目录**：`userData/plugins/`，存储用户安装的插件

## 安全考虑

GitOK 插件系统采取以下安全措施：

- **视图沙箱**：自定义视图在 iframe 沙箱中运行，限制其访问权限
- **权限控制**：插件只能通过定义的 API 访问系统功能
- **验证检查**：加载前验证插件的完整性和结构

## 下一步

继续阅读以下文档，深入了解插件系统的各个方面：

- [插件系统设计](./02-design.md)：详细的架构和设计决策
- [插件开发指南](./03-development.md)：创建您的第一个插件
- [API 参考](./04-api-reference.md)：完整的 API 文档
- [示例插件解析](./05-example-plugin.md)：分析示例插件的实现

---
