---
title: åŒçª—å£æ¨¡å¼
order: 1
---

# åŒçª—å£æ¨¡å¼å¼€å‘æŒ‡å—

Buddy æ”¯æŒä¸¤ç§çª—å£æ¨¡å¼ï¼Œæä¾›ä¸åŒçš„ç”¨æˆ·ä½“éªŒï¼šç²¾ç®€æ¨¡å¼å’Œå®Œæ•´æ¨¡å¼ã€‚

## æ¦‚è¿°

### ç²¾ç®€æ¨¡å¼ï¼ˆCompact Modeï¼‰
é€šè¿‡å¿«æ·é”®å‘¼å‡ºçš„æ‚¬æµ®çª—å£ï¼Œç±»ä¼¼ Spotlight æˆ– Raycastã€‚

**ç‰¹ç‚¹ï¼š**
- æ— è¾¹æ¡†ï¼ˆæ— çº¢ç»¿ç¯æŒ‰é’®ï¼‰
- é€æ˜èƒŒæ™¯
- æ‚¬æµ®åœ¨æ‰€æœ‰åº”ç”¨ä¹‹ä¸Š
- å¤±ç„¦è‡ªåŠ¨éšè—
- é»˜è®¤å°ºå¯¸ï¼š800x500

**è§¦å‘æ–¹å¼ï¼š** æŒ‰ä¸‹ `Option+Space`ï¼ˆå¯é…ç½®ï¼‰

### å®Œæ•´æ¨¡å¼ï¼ˆFull Modeï¼‰
ä¼ ç»Ÿçš„ macOS åº”ç”¨çª—å£ã€‚

**ç‰¹ç‚¹ï¼š**
- æœ‰è¾¹æ¡†ï¼ˆæ˜¾ç¤ºçº¢ç»¿ç¯æŒ‰é’®ï¼‰
- ä¸é€æ˜èƒŒæ™¯
- ä¸ç½®é¡¶
- ä¸ä¼šè‡ªåŠ¨éšè—
- é»˜è®¤å°ºå¯¸ï¼š1200x800

**è§¦å‘æ–¹å¼ï¼š** ç‚¹å‡» Dock å›¾æ ‡

## é…ç½®

åœ¨ `WindowServiceProvider.ts` ä¸­é…ç½®ä¸¤ç§æ¨¡å¼çš„å‚æ•°ï¼š

```typescript
const windowConfig = {
  hotkey: 'Option+Space', // å¿«æ·é”®
  
  // ç²¾ç®€æ¨¡å¼é…ç½®ï¼ˆæ‚¬æµ®çª—å£ï¼‰
  compactMode: {
    width: 800,
    height: 500,
    hideOnBlur: true,      // å¤±ç„¦éšè—
    frame: false,          // æ— è¾¹æ¡†
    transparent: true,     // é€æ˜èƒŒæ™¯
    alwaysOnTop: true,     // ç½®é¡¶
    opacity: 0.99,
  },
  
  // å®Œæ•´æ¨¡å¼é…ç½®ï¼ˆä¼ ç»Ÿçª—å£ï¼‰
  fullMode: {
    width: 1200,
    height: 800,
    hideOnBlur: false,     // ä¸è‡ªåŠ¨éšè—
    frame: true,           // æ˜¾ç¤ºè¾¹æ¡†
    transparent: false,    // ä¸é€æ˜
    alwaysOnTop: false,    // ä¸ç½®é¡¶
    opacity: 1.0,
  },
  
  currentMode: 'compact', // é»˜è®¤æ¨¡å¼
};
```

## ä¸»è¿›ç¨‹ API

### WindowManager æ–¹æ³•

```typescript
// åˆ‡æ¢çª—å£æ¨¡å¼
windowManager.switchMode('compact' | 'full');

// è·å–å½“å‰æ¨¡å¼
const mode = windowManager.getCurrentMode();

// å¿«æ·é”®è§¦å‘ï¼ˆç²¾ç®€æ¨¡å¼ï¼‰
windowManager.toggleMainWindow();

// Dock è§¦å‘ï¼ˆå®Œæ•´æ¨¡å¼ï¼‰
windowManager.showFullWindow();
```

### å·¥ä½œæµç¨‹

#### å¿«æ·é”®è§¦å‘æµç¨‹
1. ç”¨æˆ·æŒ‰ä¸‹ `Option+Space`
2. `toggleMainWindow()` è¢«è°ƒç”¨
3. å¦‚æœçª—å£éšè—ï¼Œè°ƒç”¨ `switchMode('compact')`
4. åˆ›å»ºæ— è¾¹æ¡†ã€é€æ˜çš„æ‚¬æµ®çª—å£
5. æ˜¾ç¤ºçª—å£å¹¶å±…ä¸­åœ¨é¼ æ ‡æ‰€åœ¨å±å¹•
6. å¤±ç„¦æ—¶è‡ªåŠ¨éšè—

#### Dock ç‚¹å‡»æµç¨‹
1. ç”¨æˆ·ç‚¹å‡» Dock å›¾æ ‡
2. `activate` äº‹ä»¶è§¦å‘
3. `showFullWindow()` è¢«è°ƒç”¨
4. å¦‚æœå½“å‰æ˜¯ç²¾ç®€æ¨¡å¼ï¼Œè°ƒç”¨ `switchMode('full')`
5. åˆ›å»ºæœ‰è¾¹æ¡†ã€ä¸é€æ˜çš„ä¼ ç»Ÿçª—å£
6. æ˜¾ç¤ºçª—å£å¹¶å±…ä¸­
7. ä¸ä¼šè‡ªåŠ¨éšè—

## å‰ç«¯é€‚é…

### ä½¿ç”¨ Composable

åœ¨ Vue ç»„ä»¶ä¸­ä½¿ç”¨ `useWindowMode`ï¼š

```vue
<script setup lang="ts">
import { useWindowMode } from '@/ui/composables/useWindowMode';

const { mode, isCompact, isFull } = useWindowMode();
</script>

<template>
  <div>
    <div v-if="isCompact()">
      <!-- ç²¾ç®€æ¨¡å¼ç•Œé¢ -->
      <CompactView />
    </div>
    <div v-else>
      <!-- å®Œæ•´æ¨¡å¼ç•Œé¢ -->
      <FullView />
    </div>
  </div>
</template>
```

### ä½¿ç”¨ CSS ç±»å

é€šè¿‡ CSS ç±»åé€‚é…ä¸åŒæ¨¡å¼ï¼š

```css
/* ç²¾ç®€æ¨¡å¼æ ·å¼ */
body.compact-mode .sidebar {
  display: none;
}

body.compact-mode .header {
  height: 40px;
}

body.compact-mode #app {
  border-radius: 12px;
  overflow: hidden;
}

/* å®Œæ•´æ¨¡å¼æ ·å¼ */
body.full-mode .sidebar {
  display: block;
}

body.full-mode .header {
  height: 60px;
}

body.full-mode #app {
  border-radius: 0;
}
```

### ç›‘å¬æ¨¡å¼å˜åŒ–

```typescript
// åœ¨ç»„ä»¶ä¸­ç›‘å¬
window.addEventListener('window-mode-changed', (event: CustomEvent) => {
  const mode = event.detail; // 'compact' | 'full'
  console.log('çª—å£æ¨¡å¼å˜åŒ–:', mode);
});

// æˆ–ä½¿ç”¨ IPC
ipc.receive('window-mode-changed', (mode: 'compact' | 'full') => {
  // å¤„ç†æ¨¡å¼å˜åŒ–
});
```

## æŠ€æœ¯å®ç°

### ä¸ºä»€ä¹ˆè¦é‡å»ºçª—å£ï¼Ÿ

Electron çš„ `BrowserWindow` æœ‰äº›å±æ€§åœ¨åˆ›å»ºåæ— æ³•ä¿®æ”¹ï¼š
- `frame`: çª—å£è¾¹æ¡†
- `transparent`: é€æ˜èƒŒæ™¯

å› æ­¤åˆ‡æ¢æ¨¡å¼æ—¶å¿…é¡»é‡æ–°åˆ›å»ºçª—å£ã€‚

### å¹³æ»‘è¿‡æ¸¡å®ç°

```typescript
public switchMode(mode: WindowMode): void {
  // 1. ä¿å­˜å½“å‰ URL
  const currentURL = this.mainWindow.webContents.getURL();
  
  // 2. åˆ›å»ºæ–°çª—å£ï¼ˆéšè—çŠ¶æ€ï¼‰
  this.mainWindow = new BrowserWindow({
    // ... æ–°æ¨¡å¼çš„é…ç½®
    show: false,
  });
  
  // 3. åŠ è½½å†…å®¹
  this.mainWindow.loadURL(currentURL);
  
  // 4. ç­‰å¾…åŠ è½½å®Œæˆ
  this.mainWindow.once('ready-to-show', () => {
    // 5. æ˜¾ç¤ºæ–°çª—å£
    this.mainWindow.show();
    
    // 6. é€šçŸ¥æ¸²æŸ“è¿›ç¨‹
    this.mainWindow.webContents.send('window-mode-changed', mode);
    
    // 7. å…³é—­æ—§çª—å£
    oldWindow.close();
  });
}
```

### æ¨¡å¼è¯†åˆ«

é€šè¿‡è§¦å‘æ–¹å¼åŒºåˆ†æ¨¡å¼ï¼š

| è§¦å‘æ–¹å¼ | è°ƒç”¨æ–¹æ³• | ä½¿ç”¨æ¨¡å¼ |
|---------|---------|---------|
| å¿«æ·é”® | `toggleMainWindow()` | ç²¾ç®€æ¨¡å¼ |
| Dock ç‚¹å‡» | `showFullWindow()` | å®Œæ•´æ¨¡å¼ |

## ç¤ºä¾‹ç»„ä»¶

### çª—å£æ¨¡å¼æŒ‡ç¤ºå™¨

```vue
<script setup lang="ts">
import { useWindowMode } from '@/ui/composables/useWindowMode';

const { mode, isCompact, isFull } = useWindowMode();
</script>

<template>
  <div class="mode-badge" :class="{ 'compact': isCompact(), 'full': isFull() }">
    <span class="mode-icon">{{ isCompact() ? 'âš¡' : 'ğŸ–¥ï¸' }}</span>
    <span class="mode-text">{{ isCompact() ? 'ç²¾ç®€æ¨¡å¼' : 'å®Œæ•´æ¨¡å¼' }}</span>
  </div>
</template>

<style scoped>
.mode-badge.compact {
  background-color: rgba(59, 130, 246, 0.1);
  color: rgb(59, 130, 246);
}

.mode-badge.full {
  background-color: rgba(16, 185, 129, 0.1);
  color: rgb(16, 185, 129);
}
</style>
```

## æµ‹è¯•å»ºè®®

### ç²¾ç®€æ¨¡å¼æµ‹è¯•
- [ ] æŒ‰ `Option+Space` æ‰“å¼€
- [ ] æ£€æŸ¥æ˜¯å¦æ— è¾¹æ¡†
- [ ] æ£€æŸ¥æ˜¯å¦é€æ˜èƒŒæ™¯
- [ ] æ£€æŸ¥å¤±ç„¦æ˜¯å¦éšè—
- [ ] æ£€æŸ¥æ˜¯å¦ç½®é¡¶

### å®Œæ•´æ¨¡å¼æµ‹è¯•
- [ ] ç‚¹å‡» Dock å›¾æ ‡
- [ ] æ£€æŸ¥æ˜¯å¦æœ‰çº¢ç»¿ç¯æŒ‰é’®
- [ ] æ£€æŸ¥æ˜¯å¦ä¸é€æ˜
- [ ] æ£€æŸ¥å¤±ç„¦æ˜¯å¦ä¸éšè—
- [ ] æ£€æŸ¥æ˜¯å¦ä¸ç½®é¡¶

### åˆ‡æ¢æµ‹è¯•
- [ ] ä»ç²¾ç®€æ¨¡å¼åˆ‡æ¢åˆ°å®Œæ•´æ¨¡å¼
- [ ] ä»å®Œæ•´æ¨¡å¼åˆ‡æ¢åˆ°ç²¾ç®€æ¨¡å¼
- [ ] æ£€æŸ¥å†…å®¹æ˜¯å¦ä¿ç•™
- [ ] æ£€æŸ¥åˆ‡æ¢æ˜¯å¦æµç•…

## å‚è€ƒæ¡ˆä¾‹

ç±»ä¼¼çš„åº”ç”¨å®ç°ï¼š
- **Raycast** - å¿«æ·é”®å‘¼å‡ºç²¾ç®€æœç´¢æ¡†ï¼Œèœå•æ å›¾æ ‡æ˜¾ç¤ºå®Œæ•´ç•Œé¢
- **Alfred** - åŒæ¨¡å¼è®¾è®¡
- **Spotlight** - macOS åŸç”Ÿç²¾ç®€æœç´¢

## ç›¸å…³æ–‡ä»¶

- `packages/buddy/src/main/providers/window/WindowManager.ts` - çª—å£ç®¡ç†å™¨
- `packages/buddy/src/main/providers/window/IWindowConfig.ts` - é…ç½®æ¥å£
- `packages/buddy/src/main/providers/window/WindowServiceProvider.ts` - æœåŠ¡æä¾›è€…
- `packages/buddy/src/main/managers/AppManager.ts` - åº”ç”¨ç®¡ç†å™¨
- `packages/buddy/src/ui/composables/useWindowMode.ts` - Vue Composable
- `packages/buddy/src/ui/components/WindowModeIndicator.vue` - ç¤ºä¾‹ç»„ä»¶
